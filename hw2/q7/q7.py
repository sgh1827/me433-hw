import matplotlib.pyplot as plt
import numpy as np
import csv

title1 = "Sampling rate=1000 Hz, fL=20Hz, bL=5Hz, Hamming"
title2 = "Sampling rate=500 Hz, fL=7Hz, bL=7Hz, Hamming"
title3 = "Sampling rate=10 Hz, fL=0.8Hz, bL=0.4Hz, Blackman"
title4 = "Sampling rate=20 Hz, fL=1Hz, bL=1Hz, Hamming"

h1 = [
    0.000156288483082234,
    0.000139815522983287,
    0.000114501418668350,
    0.000081587645593720,
    0.000042742451112418,
    0.000000000000000000,
    -0.000044318607541483,
    -0.000087701911595852,
    -0.000127560900813906,
    -0.000161355556692589,
    -0.000186731259060057,
    -0.000201659669579224,
    -0.000204577223391550,
    -0.000194513072171265,
    -0.000171197422346243,
    -0.000135140877570686,
    -0.000087675772136789,
    -0.000030951670334666,
    0.000032120760559218,
    0.000097980461193072,
    0.000162580718499928,
    0.000221603383278856,
    0.000270713819336359,
    0.000305843751508902,
    0.000323485560261434,
    0.000320978768556500,
    0.000296767805577296,
    0.000250609875565500,
    0.000183713085063431,
    0.000098787954452007,
    -0.000000000000000001,
    -0.000107182971850056,
    -0.000216248187035421,
    -0.000319991505403682,
    -0.000410951184183989,
    -0.000481898376001649,
    -0.000526354688028217,
    -0.000539102511910971,
    -0.000516651333835426,
    -0.000457623217231811,
    -0.000363023325727442,
    -0.000236366743181485,
    -0.000083640771298089,
    0.000086908039566700,
    0.000265161216370849,
    0.000439676634401310,
    0.000598371821179117,
    0.000729304791948506,
    0.000821505145905302,
    0.000865801041791273,
    0.000855583924027791,
    0.000787452994268828,
    0.000661685680200034,
    0.000482488724589647,
    0.000257996686232844,
    -0.000000000000000001,
    -0.000276597592955085,
    -0.000554573561852974,
    -0.000815395543251675,
    -0.001040389788660557,
    -0.001211999407915355,
    -0.001315051873906567,
    -0.001337949326514577,
    -0.001273694918781941,
    -0.001120674155116775,
    -0.000883121849566127,
    -0.000571222532375284,
    -0.000200813993944949,
    0.000207311058803069,
    0.000628483092528185,
    0.001035564159896552,
    0.001400611681487740,
    0.001696700725215257,
    0.001899791311771623,
    0.001990517433668506,
    0.001955772447497372,
    0.001789971861191064,
    0.001495889325584764,
    0.001084984315335843,
    0.000577169445952989,
    -0.000000000000000002,
    -0.000612694029944585,
    -0.001222674605237457,
    -0.001789565579405861,
    -0.002273398190218128,
    -0.002637278859269255,
    -0.002850009350902531,
    -0.002888483040560428,
    -0.002739686102242869,
    -0.002402149098171592,
    -0.001886722234293103,
    -0.001216585164717503,
    -0.000426447705337721,
    0.000439051444685967,
    0.001327687943661858,
    0.002182625216475697,
    0.002945859085639341,
    0.003561935442507015,
    0.003981714404006276,
    0.004165939265975747,
    0.004088368295778621,
    0.003738242743935441,
    0.003121895162649598,
    0.002263346962842636,
    0.001203800921049654,
    -0.000000000000000002,
    -0.001278505394761130,
    -0.002553067993716865,
    -0.003740450394237201,
    -0.004757886418898192,
    -0.005528407991384933,
    -0.005986116636807162,
    -0.006081065435255719,
    -0.005783424141995709,
    -0.005086627701803195,
    -0.004009255730783690,
    -0.002595455656255423,
    -0.000913801852615485,
    0.000945426975778815,
    0.002874474795031752,
    0.004753667503740454,
    0.006458043708749768,
    0.007864719365754331,
    0.008860588551911150,
    0.009349923627799746,
    0.009261423247013383,
    0.008554267874013696,
    0.007222779969412133,
    0.005299348532538430,
    0.002855362461221400,
    -0.000000000000000003,
    -0.003123162991391932,
    -0.006341641404229536,
    -0.009461420022125995,
    -0.012275903775804212,
    -0.014576019925452991,
    -0.016160973850920995,
    -0.016849106470835921,
    -0.016488276862517415,
    -0.014965200553712510,
    -0.012213212588673816,
    -0.008217993407556306,
    -0.003020891629907454,
    0.003280403798043698,
    0.010533955102690598,
    0.018538400328513272,
    0.027050335942755171,
    0.035793944340073963,
    0.044472429847776919,
    0.052780725024176897,
    0.060418854639710307,
    0.067105302131799410,
    0.072589715190402887,
    0.076664314217700966,
    0.079173428507269022,
    0.080020676995831402,
    0.079173428507269022,
    0.076664314217700966,
    0.072589715190402887,
    0.067105302131799410,
    0.060418854639710307,
    0.052780725024176897,
    0.044472429847776926,
    0.035793944340073963,
    0.027050335942755174,
    0.018538400328513272,
    0.010533955102690598,
    0.003280403798043699,
    -0.003020891629907454,
    -0.008217993407556306,
    -0.012213212588673816,
    -0.014965200553712510,
    -0.016488276862517415,
    -0.016849106470835921,
    -0.016160973850920995,
    -0.014576019925452995,
    -0.012275903775804212,
    -0.009461420022125995,
    -0.006341641404229536,
    -0.003123162991391932,
    -0.000000000000000003,
    0.002855362461221400,
    0.005299348532538430,
    0.007222779969412134,
    0.008554267874013697,
    0.009261423247013385,
    0.009349923627799748,
    0.008860588551911150,
    0.007864719365754331,
    0.006458043708749767,
    0.004753667503740454,
    0.002874474795031752,
    0.000945426975778815,
    -0.000913801852615485,
    -0.002595455656255423,
    -0.004009255730783690,
    -0.005086627701803198,
    -0.005783424141995712,
    -0.006081065435255720,
    -0.005986116636807161,
    -0.005528407991384932,
    -0.004757886418898192,
    -0.003740450394237201,
    -0.002553067993716867,
    -0.001278505394761130,
    -0.000000000000000002,
    0.001203800921049654,
    0.002263346962842637,
    0.003121895162649598,
    0.003738242743935441,
    0.004088368295778619,
    0.004165939265975747,
    0.003981714404006276,
    0.003561935442507017,
    0.002945859085639342,
    0.002182625216475698,
    0.001327687943661859,
    0.000439051444685967,
    -0.000426447705337721,
    -0.001216585164717503,
    -0.001886722234293103,
    -0.002402149098171592,
    -0.002739686102242869,
    -0.002888483040560429,
    -0.002850009350902532,
    -0.002637278859269256,
    -0.002273398190218128,
    -0.001789565579405861,
    -0.001222674605237458,
    -0.000612694029944585,
    -0.000000000000000002,
    0.000577169445952989,
    0.001084984315335843,
    0.001495889325584764,
    0.001789971861191065,
    0.001955772447497373,
    0.001990517433668506,
    0.001899791311771624,
    0.001696700725215258,
    0.001400611681487740,
    0.001035564159896553,
    0.000628483092528186,
    0.000207311058803068,
    -0.000200813993944949,
    -0.000571222532375284,
    -0.000883121849566128,
    -0.001120674155116776,
    -0.001273694918781942,
    -0.001337949326514577,
    -0.001315051873906568,
    -0.001211999407915357,
    -0.001040389788660557,
    -0.000815395543251675,
    -0.000554573561852974,
    -0.000276597592955085,
    -0.000000000000000001,
    0.000257996686232844,
    0.000482488724589647,
    0.000661685680200034,
    0.000787452994268828,
    0.000855583924027791,
    0.000865801041791274,
    0.000821505145905302,
    0.000729304791948506,
    0.000598371821179117,
    0.000439676634401311,
    0.000265161216370850,
    0.000086908039566700,
    -0.000083640771298089,
    -0.000236366743181485,
    -0.000363023325727442,
    -0.000457623217231811,
    -0.000516651333835426,
    -0.000539102511910971,
    -0.000526354688028217,
    -0.000481898376001649,
    -0.000410951184183989,
    -0.000319991505403682,
    -0.000216248187035421,
    -0.000107182971850056,
    -0.000000000000000001,
    0.000098787954452007,
    0.000183713085063431,
    0.000250609875565500,
    0.000296767805577296,
    0.000320978768556500,
    0.000323485560261434,
    0.000305843751508902,
    0.000270713819336359,
    0.000221603383278856,
    0.000162580718499928,
    0.000097980461193072,
    0.000032120760559218,
    -0.000030951670334666,
    -0.000087675772136789,
    -0.000135140877570686,
    -0.000171197422346243,
    -0.000194513072171265,
    -0.000204577223391550,
    -0.000201659669579225,
    -0.000186731259060057,
    -0.000161355556692589,
    -0.000127560900813906,
    -0.000087701911595852,
    -0.000044318607541483,
    0.000000000000000000,
    0.000042742451112418,
    0.000081587645593720,
    0.000114501418668350,
    0.000139815522983287,
    0.000156288483082234,
] 

h2 = [
    -0.000076223319503650,
    -0.000057605826706072,
    -0.000038280415188408,
    -0.000018098061886567,
    0.000003095388794246,
    0.000025452816240183,
    0.000049119116886486,
    0.000074224314818235,
    0.000100876611146124,
    0.000129155498012415,
    0.000159105065750858,
    0.000190727632569225,
    0.000223977825098374,
    0.000258757235235916,
    0.000294909773909088,
    0.000332217835719084,
    0.000370399379961637,
    0.000409106023325087,
    0.000447922227750146,
    0.000486365653621457,
    0.000523888733797607,
    0.000559881508141849,
    0.000593675741376909,
    0.000624550329456893,
    0.000651737981444058,
    0.000674433145326222,
    0.000691801127548384,
    0.000702988337502029,
    0.000707133570062524,
    0.000703380221733497,
    0.000690889319288259,
    0.000668853224226597,
    0.000636509862115476,
    0.000593157313166652,
    0.000538168589419611,
    0.000471006414823369,
    0.000391237817503467,
    0.000298548338696110,
    0.000192755660340084,
    0.000073822453222329,
    -0.000058131750069577,
    -0.000202819848299050,
    -0.000359777814436749,
    -0.000528356862070537,
    -0.000707717297090346,
    -0.000896824201958909,
    -0.001094445083310401,
    -0.001299149595043250,
    -0.001509311428669235,
    -0.001723112440652249,
    -0.001938549063043019,
    -0.002153441019138020,
    -0.002365442340426393,
    -0.002572054655017874,
    -0.002770642691359050,
    -0.002958451914645001,
    -0.003132628187223454,
    -0.003290239318775908,
    -0.003428298347449189,
    -0.003543788369700596,
    -0.003633688714699710,
    -0.003695002238976829,
    -0.003724783498882697,
    -0.003720167542567585,
    -0.003678399049818776,
    -0.003596861537407479,
    -0.003473106339754653,
    -0.003304881069865719,
    -0.003090157263710288,
    -0.002827156912604680,
    -0.002514377592727534,
    -0.002150615908662084,
    -0.001734988978776524,
    -0.001266953704254352,
    -0.000746323580562665,
    -0.000173282829955996,
    0.000451602343918516,
    0.001127375553328428,
    0.001852685222553595,
    0.002625782900562947,
    0.003444524977305728,
    0.004306377858542879,
    0.005208426621005693,
    0.006147387135843589,
    0.007119621614162313,
    0.008121157494318925,
    0.009147709556891263,
    0.010194705120240509,
    0.011257312137690413,
    0.012330469986904508,
    0.013408922713386267,
    0.014487254463474574,
    0.015559926818054846,
    0.016621317716727486,
    0.017665761643616572,
    0.018687590730577706,
    0.019681176421460004,
    0.020640971332440382,
    0.021561550938392560,
    0.022437654713851982,
    0.023264226359427750,
    0.024036452750488994,
    0.024749801254573645,
    0.025400055077148955,
    0.025983346311975148,
    0.026496186392227793,
    0.026935493661527629,
    0.027298617809880923,
    0.027583360947991697,
    0.027787995124181286,
    0.027911276120930438,
    0.027952453402509323,
    0.027911276120930438,
    0.027787995124181286,
    0.027583360947991697,
    0.027298617809880923,
    0.026935493661527629,
    0.026496186392227793,
    0.025983346311975148,
    0.025400055077148959,
    0.024749801254573652,
    0.024036452750488994,
    0.023264226359427750,
    0.022437654713851982,
    0.021561550938392560,
    0.020640971332440385,
    0.019681176421460004,
    0.018687590730577706,
    0.017665761643616572,
    0.016621317716727486,
    0.015559926818054846,
    0.014487254463474574,
    0.013408922713386267,
    0.012330469986904508,
    0.011257312137690417,
    0.010194705120240510,
    0.009147709556891263,
    0.008121157494318925,
    0.007119621614162315,
    0.006147387135843589,
    0.005208426621005693,
    0.004306377858542881,
    0.003444524977305729,
    0.002625782900562947,
    0.001852685222553595,
    0.001127375553328429,
    0.000451602343918516,
    -0.000173282829955996,
    -0.000746323580562665,
    -0.001266953704254352,
    -0.001734988978776524,
    -0.002150615908662084,
    -0.002514377592727534,
    -0.002827156912604681,
    -0.003090157263710288,
    -0.003304881069865719,
    -0.003473106339754653,
    -0.003596861537407482,
    -0.003678399049818776,
    -0.003720167542567585,
    -0.003724783498882699,
    -0.003695002238976830,
    -0.003633688714699711,
    -0.003543788369700598,
    -0.003428298347449190,
    -0.003290239318775909,
    -0.003132628187223452,
    -0.002958451914645001,
    -0.002770642691359051,
    -0.002572054655017874,
    -0.002365442340426393,
    -0.002153441019138020,
    -0.001938549063043020,
    -0.001723112440652251,
    -0.001509311428669235,
    -0.001299149595043250,
    -0.001094445083310402,
    -0.000896824201958908,
    -0.000707717297090346,
    -0.000528356862070537,
    -0.000359777814436750,
    -0.000202819848299050,
    -0.000058131750069577,
    0.000073822453222329,
    0.000192755660340084,
    0.000298548338696111,
    0.000391237817503467,
    0.000471006414823369,
    0.000538168589419610,
    0.000593157313166651,
    0.000636509862115475,
    0.000668853224226597,
    0.000690889319288259,
    0.000703380221733497,
    0.000707133570062524,
    0.000702988337502029,
    0.000691801127548385,
    0.000674433145326223,
    0.000651737981444058,
    0.000624550329456893,
    0.000593675741376909,
    0.000559881508141849,
    0.000523888733797607,
    0.000486365653621457,
    0.000447922227750146,
    0.000409106023325087,
    0.000370399379961637,
    0.000332217835719084,
    0.000294909773909088,
    0.000258757235235916,
    0.000223977825098374,
    0.000190727632569225,
    0.000159105065750858,
    0.000129155498012415,
    0.000100876611146124,
    0.000074224314818235,
    0.000049119116886486,
    0.000025452816240183,
    0.000003095388794246,
    -0.000018098061886567,
    -0.000038280415188408,
    -0.000057605826706072,
    -0.000076223319503650,
]


h3 = [
    0.000000000000000000,
    0.000000194991440842,
    0.000003736580644603,
    0.000013253162929722,
    0.000026676722959331,
    0.000036281578173341,
    0.000030738735829931,
    0.000000000000000000,
    -0.000058460016864317,
    -0.000134491040431008,
    -0.000203885933459935,
    -0.000232689553002326,
    -0.000187391124590323,
    -0.000048904972386655,
    0.000173902185201619,
    0.000436543572523027,
    0.000661987344392553,
    0.000756868493651799,
    0.000639141196429114,
    0.000270823789765539,
    -0.000314204638543489,
    -0.000998559886252990,
    -0.001594618135060192,
    -0.001885311704502618,
    -0.001686430163633210,
    -0.000915582425275274,
    0.000353073753530016,
    0.001869821075401000,
    0.003241250154139957,
    0.004015429238201705,
    0.003806381913349995,
    0.002428267725845058,
    -0.000000000000000003,
    -0.003018413111222756,
    -0.005883893672571403,
    -0.007725636815275054,
    -0.007772160210976859,
    -0.005598096660529766,
    -0.001322885094498978,
    0.004305414601565204,
    0.009987448989882498,
    0.014120183724577774,
    0.015178250826759932,
    0.012149833720135882,
    0.004920592693072557,
    -0.005503268840877422,
    -0.017015407995737506,
    -0.026704496820030125,
    -0.031389875231484697,
    -0.028299444844075098,
    -0.015745841048341175,
    0.006357112902260284,
    0.036271895104020270,
    0.070584595908706194,
    0.104717320871412112,
    0.133716760878801438,
    0.153162703824974766,
    0.160006927358090190,
    0.153162703824974794,
    0.133716760878801438,
    0.104717320871412112,
    0.070584595908706194,
    0.036271895104020263,
    0.006357112902260285,
    -0.015745841048341175,
    -0.028299444844075105,
    -0.031389875231484704,
    -0.026704496820030118,
    -0.017015407995737506,
    -0.005503268840877422,
    0.004920592693072560,
    0.012149833720135885,
    0.015178250826759932,
    0.014120183724577779,
    0.009987448989882502,
    0.004305414601565206,
    -0.001322885094498979,
    -0.005598096660529766,
    -0.007772160210976864,
    -0.007725636815275058,
    -0.005883893672571407,
    -0.003018413111222756,
    -0.000000000000000003,
    0.002428267725845058,
    0.003806381913349994,
    0.004015429238201705,
    0.003241250154139959,
    0.001869821075401003,
    0.000353073753530016,
    -0.000915582425275274,
    -0.001686430163633211,
    -0.001885311704502618,
    -0.001594618135060193,
    -0.000998559886252992,
    -0.000314204638543489,
    0.000270823789765539,
    0.000639141196429115,
    0.000756868493651801,
    0.000661987344392554,
    0.000436543572523026,
    0.000173902185201620,
    -0.000048904972386654,
    -0.000187391124590323,
    -0.000232689553002326,
    -0.000203885933459934,
    -0.000134491040431008,
    -0.000058460016864318,
    0.000000000000000000,
    0.000030738735829931,
    0.000036281578173342,
    0.000026676722959331,
    0.000013253162929721,
    0.000003736580644603,
    0.000000194991440842,
    0.000000000000000000,
]

h4 = [
    -0.000253459943825063,
    0.000000000000000000,
    0.000302830339756015,
    0.000674517240403855,
    0.001116900068473316,
    0.001602074199064700,
    0.002065262319798868,
    0.002405258635128460,
    0.002493904450069028,
    0.002194520824768990,
    0.001387538282060154,
    -0.000000000000000001,
    -0.001965553032366434,
    -0.004407851448190564,
    -0.007114138083339106,
    -0.009761681719536000,
    -0.011935650779369327,
    -0.013163227073164923,
    -0.012961439782744198,
    -0.010893952772232074,
    -0.006630287645948816,
    0.000000000000000003,
    0.008965663696416900,
    0.020011059275436848,
    0.032656834152381096,
    0.046225759097354151,
    0.059892372368256709,
    0.072752056320232072,
    0.083902556849476798,
    0.092529150734204355,
    0.097983928188092970,
    0.099850110478682322,
    0.097983928188092970,
    0.092529150734204355,
    0.083902556849476798,
    0.072752056320232072,
    0.059892372368256723,
    0.046225759097354165,
    0.032656834152381096,
    0.020011059275436852,
    0.008965663696416900,
    0.000000000000000003,
    -0.006630287645948815,
    -0.010893952772232075,
    -0.012961439782744206,
    -0.013163227073164927,
    -0.011935650779369335,
    -0.009761681719535996,
    -0.007114138083339107,
    -0.004407851448190566,
    -0.001965553032366434,
    -0.000000000000000001,
    0.001387538282060154,
    0.002194520824768992,
    0.002493904450069028,
    0.002405258635128459,
    0.002065262319798868,
    0.001602074199064702,
    0.001116900068473316,
    0.000674517240403855,
    0.000302830339756015,
    0.000000000000000000,
    -0.000253459943825063,
]
#def filteration(old,new,start, x):
 #   sum=0
  #  for i in range(x):
   #     sum = sum + old[(start)+i]
        
    #new.append(sum/x)

def FIR(olist, nlist, start_index, h):
    buffer = []
    for ii in range(len(h)):
        buffer.append(olist[start_index+ii])
    nlist.append(np.average(buffer, weights=h))
    
def fft_plot(t, nt, s, ns,title):
    
    #dt = 1.0/10000.0 # 10kHz
    t = np.asarray(t)
    nt = np.asarray(nt)
    Fs = 10000 # sample rate
    Ts = 1.0/Fs; # sampling interval
    ts = np.arange(0,t[-1],Ts) # time vector
    y = s # the data to make the fft from
    n = len(y) # length of the signal
    k = np.arange(n)
    T = n/Fs
    frq = k/T # two sides frequency range
    frq = frq[range(int(n/2))] # one side frequency range
    Y = np.fft.fft(y)/n # fft computing and normalization
    Y = Y[range(int(n/2))]
    
    nts = np.arange(0,nt[-1],Ts) # time vector
    ny = ns # the data to make the fft from
    nn = len(ny) # length of the signal
    nk = np.arange(nn)
    nT = nn/Fs
    nfrq = nk/nT # two sides frequency range
    nfrq = nfrq[range(int(nn/2))] # one side frequency range
    nY = np.fft.fft(ny)/nn # fft computing and normalization
    nY = nY[range(int(nn/2))]

    fig, (ax1, ax2) = plt.subplots(2, 1)
    ax1.set_title(title)
    #ax1.plot(t,y,'b')
    #ax1.set_xlabel('Time')
    #ax1.set_ylabel('Amplitude')
    ax1.plot(t, s, 'black')
    ax1.plot(nt, ns, 'red') #filtered
    ax1.set_xlabel('Time [s]')
    ax1.set_ylabel('Signal')
    ax2.loglog(frq,abs(Y),'black') # plotting the fft
    ax2.loglog(nfrq,abs(nY),'red') # plotting the filtered fft
    ax2.set_xlabel('Freq (Hz)')
    ax2.set_ylabel('|Y(freq)|')
    #plt.show()
    


t1 = [] # column 0
data1 = [] # column 1
t2 = [] # column 0
data2 = [] # column 1
t3 = [] # column 0
data3 = [] # column 1
t4 = [] # column 0
data4 = [] # column 1
nt1 = []
nt2 = []
nt3 = []
nt4 = []
ndata1 = []
ndata2 = []
ndata3 = []
ndata4 = []


with open('sigA.csv') as f:
    # open the csv file
    reader = csv.reader(f)
    for row in reader:
        # read the rows 1 one by one
        t1.append(float(row[0])) # leftmost column
        data1.append(float(row[1])) # second column
        #data2.append(float(row[2])) # third column
#fft_plot(t1,data1)

dt1 = len(t1)/t1[-1]
for ii in range(len(data1)-len(h1)):
    FIR(data1, ndata1, ii, h1)
print("Sample rate 1: " + str(dt1))
nt1 = t1[:len(data1)-len(h1)]
fft_plot(t1, nt1, data1, ndata1, title1)



with open('sigB.csv') as g:
    # open the csv file
    reader = csv.reader(g)
    for row in reader:
        # read the rows 1 one by one
        t2.append(float(row[0])) # leftmost column
        data2.append(float(row[1])) # second column
        #data2.append(float(row[2])) # third column
#fft_plot(t2,data2) 
dt2 = len(t2)/t2[-1]
for ii in range(len(data2)-len(h2)):
    FIR(data2, ndata2, ii, h2)
print("Sample rate 2: " + str(dt1))
nt2 = t2[:len(data2)-len(h2)]
fft_plot(t2, nt2, data2, ndata2, title2)      


with open('sigC.csv') as h:
    # open the csv file
    reader = csv.reader(h)
    for row in reader:
        # read the rows 1 one by one
        t3.append(float(row[0])) # leftmost column
        data3.append(float(row[1])) # second column
        #data2.append(float(row[2])) # third column
#fft_plot(t3,data3)
dt3 = len(t3)/t3[-1]
for ii in range(len(data3)-len(h3)):
    FIR(data3, ndata3, ii, h3)
print("Sample rate 3: " + str(dt3))
nt3 = t3[:len(data3)-len(h3)]
fft_plot(t3, nt3, data3, ndata3, title3)



with open('sigD.csv') as m:
    # open the csv file
    reader = csv.reader(m)
    for row in reader:
        # read the rows 1 one by one
        t4.append(float(row[0])) # leftmost column
        data4.append(float(row[1])) # second column
        #data2.append(float(row[2])) # third column
#fft_plot(t4,data4)

dt4 = len(t4)/t4[-1]
ndata4 = []
for ii in range(len(data4)-len(h4)):
    FIR(data4, ndata4, ii, h4)
print("Sample rate 4: " + str(dt4))
nt4 = t4[:len(data4)-len(h4)]
fft_plot(t4, nt4, data4, ndata4, title4)
